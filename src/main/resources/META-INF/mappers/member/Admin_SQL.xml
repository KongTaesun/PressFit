<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<!-- java Resource/src/main/resources/mappers/
    businessMapper.xml -->
<!-- 다른 mapper와 중복되지 않도록 네임스페이스 기재 -->
<mapper namespace="admin">
	<insert id="create" parameterType="kr.co.pressfit.vo.AdminVO">
		insert into Aadmin (id,pw,pw2) values (#{id},#{pw},#{pw2})	
	</insert>
	<select id="read" resultType="kr.co.pressfit.vo.AdminVO">
		select * from Aadmin where pw=#{pw}
	</select>
	<select id="readlist" resultType="kr.co.pressfit.vo.AdminVO">
		select * from Aadmin
	</select>
	<update id="update"> 
		update Aadmin
		set pw=#{pw}, pw2=#{pw2},name=#{name}
		where id=#{id}
	</update> 
	<delete id="delete">
		delete from Aadmin where id=#{id} and pw=#{pw} and pw2=#{pw2} 
	</delete>
	<select id="passwordcheck" resultType="int">
		select EXISTS(select * from Aadmin where id=#{id} and pw=#{pw} and pw2=#{pw2})
	</select>
	<sql id="search">
	
	</sql>
	<sql id="pagingPre">
		<![CDATA[
		select @i as TOTAL, AAA.*
		from(
		select
		@i := @i + 1 as RNUM
		, AA.*
		from(
		]]>
		</sql>
		
		<sql id="pagingPost">
		<![CDATA[
		) AA, (select @i := 0, @j := 0) temp	
		) AAA	
		where AAA.RNUM limit #{START}, #{END}
		]]>
	</sql>
	<select id="community" parameterType="kr.co.pressfit.vo.CommunityVO" resultType="kr.co.pressfit.vo.CommunityVO">
	    <include refid="pagingPre"/>
	    <![CDATA[
		SELECT @ROWNUM:=@ROWNUM+1 AS rownum, b.idx, b.title, b.content, b.writer, b.regdate, b.viewcnt,b.ref,b.turn,b.level,
      	(SELECT COUNT(*) FROM CommunityReply WHERE boardno=b.idx) AS recnt
      	FROM CommunityBoard b, Cmember m,(SELECT @ROWNUM := 0) R
      	WHERE b.writer = m.id AND showdel = 'y'
	    ]]>
		<include refid="search"></include>
		ORDER BY b.ref desc,b.turn,b.level
	    <include refid="pagingPost"/>
	</select>
	
</mapper>

 












